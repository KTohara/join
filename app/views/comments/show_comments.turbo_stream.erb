<% if @parent.present? %>
  <%= turbo_stream.append dom_id(@parent, :comments) do %>
    <%= render partial: 'comments/parent_comment',
      collection: @comments, as: :comment,
      locals: { user: @parent.user } %>
  <% end %>
<% else %>
  <%= turbo_stream.append dom_id(@commentable, :comments) do %>
    <%= render partial: 'comments/parent_comment',
      collection: @comments, as: :comment,
      locals: { user: @commentable.user } %>
  <% end %>
<% end %>

<%= turbo_stream.update(dom_id(@parent || @commentable, :load)) do %>
  <% if @pagy.next.present? %>
    <% if @parent.present? %>
      <%= button_to 'Load more...', pagy_url_for(@pagy, @pagy.next), id: "load_button_#{@parent.id || @commentable.id }", class: "ml-8 hover:underline text-xs" %>
    <% else %>
      <%= button_to 'Load more...', pagy_url_for(@pagy, @pagy.next), id: "load_button_#{@parent.id || @commentable.id }", class: 'hover:underline text-xs' %>
    <% end %>
  <% end %>
<% end %>